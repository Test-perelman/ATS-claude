╔════════════════════════════════════════════════════════════════════════════╗
║                                                                            ║
║         IF YOU SIGNUP RIGHT NOW - WHAT HAPPENS TO YOUR TEAM_ID & ROLE     ║
║                                                                            ║
╚════════════════════════════════════════════════════════════════════════════╝

ACTUAL SIGNUP PROCESS (Verified with Live Database Test)
═════════════════════════════════════════════════════════════════════════════

When you go to http://localhost:3001/auth/signup and create an account:

STEP 1: You enter email and password
────────────────────────────────────
   Email: newemail@example.com
   Password: YourPassword123

STEP 2: System creates Supabase Auth User
──────────────────────────────────────────
   Supabase generates unique User ID (UUID)
   Example: 50d9c26d-0a77-4d7e-b549-6ac3718bc382

STEP 3: System AUTO-GENERATES TEAM_ID
──────────────────────────────────────
   A UNIQUE UUID is generated by crypto.randomUUID()
   Example: 83201282-65a1-4b78-b853-dce95e7559af

   THIS BECOMES YOUR team_id!

STEP 4: System creates TEAM record in database
───────────────────────────────────────────────
   Team Name: "newuser's Team" (from email prefix)
   Team ID: 83201282-65a1-4b78-b853-dce95e7559af (the UUID from Step 3)

   teams table now has:
   ├─ id = 83201282-65a1-4b78-b853-dce95e7559af
   └─ name = "newuser's Team"

STEP 5: System creates ADMIN ROLE for your team
────────────────────────────────────────────────
   Role Name: "Admin"
   is_admin: true (has admin permissions)
   team_id: 83201282-65a1-4b78-b853-dce95e7559af (linked to your team)

   roles table now has:
   ├─ id = bd16e508-5f47-479f-9eee-d3c32155cca2
   ├─ name = "Admin"
   ├─ is_admin = true
   └─ team_id = 83201282-65a1-4b78-b853-dce95e7559af

STEP 6: System updates USER record with team_id and role_id
───────────────────────────────────────────────────────────
   users table updated:
   ├─ id = 50d9c26d-0a77-4d7e-b549-6ac3718bc382
   ├─ email = newemail@example.com
   ├─ team_id = 83201282-65a1-4b78-b853-dce95e7559af ← ASSIGNED
   ├─ role_id = bd16e508-5f47-479f-9eee-d3c32155cca2 ← ASSIGNED
   └─ is_master_admin = false

STEP 7: Page shows success and redirects
─────────────────────────────────────────
   Message: "Account created! Setting up your team..."
   Redirect: /onboarding (after 1 second)

═════════════════════════════════════════════════════════════════════════════

FINAL ANSWER: YOUR ASSIGNMENTS AFTER SIGNUP
═════════════════════════════════════════════════════════════════════════════

✅ TEAM_ID:
   └─ ASSIGNED: YES
   └─ Value: AUTO-GENERATED UUID (e.g., 83201282-65a1-4b78-b853-dce95e7559af)
   └─ How: System generates unique ID via crypto.randomUUID()
   └─ Stored in: users.team_id column
   └─ Links you to: Your personal team created at signup

✅ ROLE:
   └─ ASSIGNED: YES
   └─ Value: "Admin" role with is_admin=true
   └─ How: System creates Admin role for your team during signup
   └─ Stored in: users.role_id column
   └─ Permissions: Full team management, member approval, etc.

✅ YOUR STATUS AFTER SIGNUP:
   ├─ Authenticated: YES (logged in)
   ├─ Team Owner: YES (own a personal team)
   ├─ Team Admin: YES (have admin role)
   ├─ Master Admin: NO (only team-level, not system-wide)
   └─ Can do: Create candidates, manage team members, approve requests

═════════════════════════════════════════════════════════════════════════════

COMPARISON: The 3 Default Users vs. New Signup
═════════════════════════════════════════════════════════════════════════════

╔════════════════════════════════════════════════════════════════════════════╗
║  User Type          │  team_id           │  Role     │  is_admin  │  Master║
╠════════════════════════════════════════════════════════════════════════════╣
║  Regular User       │  5c884910-...      │  Member   │  false     │  false ║
║  (user@example.com) │  (Sample Team)     │           │            │        ║
╠════════════════════════════════════════════════════════════════════════════╣
║  Team Admin         │  5c884910-...      │  Owner    │  true      │  false ║
║  (admin@example.com)│  (Sample Team)     │           │            │        ║
╠════════════════════════════════════════════════════════════════════════════╣
║  Master Admin       │  null              │  null     │  null      │  true  ║
║  (master@example.com) │  (no team)       │           │            │        ║
╠════════════════════════════════════════════════════════════════════════════╣
║  NEW SIGNUP         │  AUTO-GENERATED    │  Admin    │  true      │  false ║
║  (you@example.com)  │  (UUID like        │           │            │        ║
║                     │  83201282-...)     │           │            │        ║
╚════════════════════════════════════════════════════════════════════════════╝

═════════════════════════════════════════════════════════════════════════════

CODE PROOF: Where This Happens
═════════════════════════════════════════════════════════════════════════════

File: src/lib/auth-actions.ts (Lines 11-83)

Function: signUp(email, password)

Step-by-step code:

1. Create auth user:
   const { data, error } = await supabase.auth.signUp({ email, password })
   └─ Supabase generates user ID

2. Generate team_id:
   const teamId = randomUUID()
   └─ Creates UNIQUE UUID for team

3. Create team:
   adminSupabase.from('teams').insert({
     id: teamId,
     name: `${email.split('@')[0]}'s Team`,
   })
   └─ Stores team with that UUID

4. Create admin role:
   adminSupabase.from('roles').insert({
     id: roleId,
     team_id: teamId,
     name: 'Admin',
     is_admin: true,
   })
   └─ Creates Admin role for the team

5. Update user record:
   adminSupabase.from('users').insert({
     id: data.user.id,           ← User ID from Step 1
     email: email,
     team_id: teamId,            ← Team ID from Step 2 (ASSIGNED HERE)
     role_id: roleId,            ← Admin role (ASSIGNED HERE)
     is_master_admin: false,
   })
   └─ Links user to team and role

═════════════════════════════════════════════════════════════════════════════

TESTED LIVE EXAMPLE
═════════════════════════════════════════════════════════════════════════════

This was tested by creating a real user and verifying the database:

User Created: newuser_1766480470471@example.com
User ID: 50d9c26d-0a77-4d7e-b549-6ac3718bc382
team_id: 83201282-65a1-4b78-b853-dce95e7559af ← AUTO-GENERATED & ASSIGNED
Role: Admin with is_admin=true

Database Verification:
├─ users table: team_id = 83201282-65a1-4b78-b853-dce95e7559af ✓
├─ teams table: id = 83201282-65a1-4b78-b853-dce95e7559af ✓
└─ roles table: is_admin = true ✓

All verified with live database queries!

═════════════════════════════════════════════════════════════════════════════

WHAT HAPPENS AT /ONBOARDING AFTER SIGNUP
═════════════════════════════════════════════════════════════════════════════

After signup, you're redirected to /onboarding page that shows:
"Choose to create or join a team"

But IMPORTANT: Your team was ALREADY CREATED at signup!

The page doesn't know about it because:
├─ The page is designed for users who DON'T have a team yet
├─ It offers "Create Team" or "Join Team" options
├─ But you already have a team_id in the database!

This is a UX quirk - the signup flow creates the team automatically,
but the onboarding page still shows the choice.

═════════════════════════════════════════════════════════════════════════════

SUMMARY
═════════════════════════════════════════════════════════════════════════════

IF YOU SIGNUP RIGHT NOW (http://localhost:3001/auth/signup):

✅ team_id:
   └─ AUTOMATICALLY ASSIGNED
   └─ Generated as UUID (e.g., 83201282-65a1-4b78-b853-dce95e7559af)
   └─ Used to create your personal team
   └─ Stored in users.team_id column

✅ Role:
   └─ AUTOMATICALLY ASSIGNED
   └─ You become "Admin" of your personal team
   └─ Has full admin permissions (is_admin=true)
   └─ Can manage team members, approve requests, create candidates

✅ Status:
   └─ You're a TEAM ADMIN (not Master Admin)
   └─ You own a personal team
   └─ You can invite others to your team
   └─ Master Admins can only be created by other Master Admins

════════════════════════════════════════════════════════════════════════════
